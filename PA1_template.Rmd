---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

[github.com/TribeTect, July 2015]

## 1. Loading and preprocessing the data
```{r}
activity <- read.csv(unz("activity.zip", "activity.csv"))
activity[["date"]] <- as.Date(activity[["date"]], "%Y-%m-%d")
str(activity)
```

## 2. What is mean total number of steps taken per day?
```{r}
activity2 <- activity[complete.cases(activity),] # ignoring NA observations for this part of the assignment
daily_steps <- tapply(X = activity2$steps,INDEX = activity2$date, FUN = "sum")
mean(daily_steps)
```

### 2.1 Total number of steps per day:
(showing first 20 daily totals)
```{r}
head(daily_steps, 20)
```

### 2.2 Histogram of steps per day:
```{r}
hist(daily_steps)
```

### 2.2 Mean and Median:
```{r}
mean(daily_steps)
median(daily_steps)
```
## 3. What is the average daily activity pattern?

### 3.1 Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
### 3.2 Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
interval_steps <- tapply(X = activity2$steps, INDEX = activity2$interval, FUN = "mean")

max_mean_steps <- as.data.frame(interval_steps[interval_steps == max(interval_steps)])
max_mean_x = row.names(max_mean_steps) 
max_mean_y = max_mean_steps[[1]]

plot(x = row.names(interval_steps), y = interval_steps, xlab = "Interval", ylab = "Mean steps", type = "l")
points(x = max_mean_x, y = max_mean_y, pch = 19, col = "red")
abline(v = max_mean_x, col = "red")

cat("The interval with highest mean: ", max_mean_x)

```

## 4. Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
